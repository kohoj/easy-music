var s=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?s(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{b as c,u as n,r,d,y as m,a8 as u,x as p,t as g,p as v,a as y,e as f,o as h,f as b,g as L,i as k,k as w,F as $,h as _,j as I,w as S,m as D}from"./vendor.55e40976.js";import{f as j}from"./song.a4f4fd39.js";import{_ as C}from"./Loading.076676db.js";import{_ as O}from"./index.80a54dc7.js";const P={setup(s){const{proxy:v}=D(),y=c(),f=n(),h=r({id:"",details:{},songList:[],collects:[],playlists:[],comments:[],total:0,isLoading:!0,isShowDesc:!1}),b=d((()=>f.getters.isLogin)),L=async s=>{const a=[];let l=[];for(let t=0;t<s.length;t+=500)a.push(s.slice(t,t+500));for(let t=0;t<a.length;t++){const s=[];a[t].map((a=>{s.push(a.id)})),h.isLoading=!0;const{data:e}=await v.$http.songDetail({ids:s.join(","),timestamp:(new Date).valueOf()+t});l=l.concat(k(e.songs,e.privileges))}h.songList=l,h.total=l.length,h.isLoading=!1},k=(s,a)=>{const l=[];return s.map(((s,t)=>{s.id&&(a&&(s.license=!a[t].cp),l.push(j(s)))})),l},w=s=>{(async s=>{h.isLoading=!0;const{data:a}=await v.$http.playlistdetail(s);if(200!==a.code)return v.$msg.error("数据请求失败");if(h.details=a.playlist,b.value){const s=a.playlist.trackIds;L(s)}else h.songList=k(a.playlist.tracks),h.total=h.songList.length,h.isLoading=!1})({id:s,s:8}),(async s=>{const{data:a}=await v.$http.playlistSCollect(s);if(200!==a.code)return v.$msg.error("数据请求失败");h.collects=a.subscribers})({id:s,limit:18}),(async s=>{const{data:a}=await v.$http.playlistRelated(s);if(200!==a.code)return v.$msg.error("数据请求失败");h.playlists=a.playlists})({id:s}),(async s=>{const{data:a}=await v.$http.playlistComment(s);if(200!==a.code)return v.$msg.error("数据请求失败");h.comments=a.comments})({id:s,limit:9})};return m((()=>b.value),((s,a)=>{if(s){const s=h.details.trackIds;L(s)}else h.songList=k(h.details.tracks),h.total=h.details.tracks.length})),u((s=>{h.songList=[],h.total=0,h.id=s.query.id,w(h.id)})),p((()=>{h.id=y.query.id,w(h.id)})),$=((s,a)=>{for(var l in a||(a={}))e.call(a,l)&&o(s,l,a[l]);if(t)for(var l of t(a))i.call(a,l)&&o(s,l,a[l]);return s})({},g(h)),a($,l({isLogin:b,loginDialog:()=>{f.dispatch("loginSuc",!0)},playAllSongs:()=>{f.dispatch("playAll",{list:h.songList}),f.commit("SET_PLAYLISTTIPS",!0)},subPlayList:async a=>{const{data:l}=await s.$http.subPlayList({id:a.id,t:a.subscribed?2:1});if(200!==l.code)return s.$msg.error("数据请求失败");h.details.subscribed=!h.details.subscribed}}));var $},components:{Loading:C,SongList:O}},q=S();v("data-v-46060b16");const A={class:"detail"},T={class:"w1200"},M={class:"detail-container"},U={class:"detail-main"},x={class:"cover"},N={class:"cover-img"},E=L("div",{slot:"placeholder",class:"image-slot"},[L("i",{class:"iconfont icon-placeholder"})],-1),H={class:"cover-info"},B={class:"cover-title"},F={key:0,class:"cover-author"},R=L("div",{slot:"placeholder",class:"image-slot"},[L("i",{class:"iconfont icon-placeholder"})],-1),Y={class:"cover-name"},z={class:"cover-date"},G={key:1,class:"cover-tags"},J={class:"cover-digital"},K={class:"cover-playCount"},Q=L("i",{class:"iconfont icon-playnum"},null,-1),V={class:"cover-collect"},W=L("i",{class:"iconfont icon-collect"},null,-1),X={class:"cover-comment"},Z=L("i",{class:"iconfont icon-comment"},null,-1),ss={class:"cover-desc"},as=I("歌单简介"),ls=L("i",{class:"iconfont icon-closed"},null,-1),ts={key:0,class:"cover-desc-all"},es={class:"song-main"},is={class:"song-header"},os=I("歌曲列表 "),cs=L("i",{class:"iconfont icon-audio-play"},null,-1),ns=I(" 播放全部"),rs={key:0,class:"showAllSongsTips"},ds={class:"detail-aside"},ms={class:"playlist-collect"},us=L("h3",{class:"aside-title"},"喜欢这个歌单的人",-1),ps={class:"aside-main collect-main"},gs=L("div",{slot:"placeholder",class:"image-slot"},[L("i",{class:"iconfont icon-placeholder"})],-1),vs={class:"playlist-recom"},ys=L("h3",{class:"aside-title"},"相关歌单推荐",-1),fs={class:"aside-main recom-main"},hs=L("div",{slot:"placeholder",class:"image-slot"},[L("i",{class:"iconfont icon-placeholder"})],-1),bs={class:"recom-info"},Ls={class:"recom-name"},ks={class:"recom-author"},ws=I(" By. "),$s={class:"playlist-comment"},_s=L("h3",{class:"aside-title"},"歌单评论",-1),Is={class:"aside-main comment-main"},Ss=L("div",{slot:"placeholder",class:"image-slot"},[L("i",{class:"iconfont icon-placeholder"})],-1),Ds={class:"comment-info"},js={class:"comment-userInfo"},Cs={class:"comment-date"},Os={class:"comment-desc"};y();const Ps=q(((s,a,l,t,e,i)=>{const o=f("el-image"),c=f("router-link"),n=f("Loading"),r=f("song-list");return h(),b("div",A,[L("div",T,[L("div",M,[L("div",U,[L("div",x,[L("div",N,[L(o,{src:s.details.coverImgUrl},{default:q((()=>[E])),_:1},8,["src"])]),L("div",H,[L("div",B,k(s.details.name),1),s.details.creator?(h(),b("div",F,[L(o,{src:s.details.creator.avatarUrl,class:"cover-avatar"},{default:q((()=>[R])),_:1},8,["src"]),L("div",Y,k(s.details.creator.nickname),1),L("div",z,k(s.$utils.formartDate(s.details.createTime,"yyyy-MM-dd")),1)])):w("",!0),s.details.tags?(h(),b("div",G,[(h(!0),b($,null,_(s.details.tags,((s,a)=>(h(),b(c,{to:{path:"/playlist",query:{cat:s}},class:"tag",key:a},{default:q((()=>[I("#"+k(s),1)])),_:2},1032,["to"])))),128))])):w("",!0),L("div",J,[L("span",K,[Q,I(" "+k(s.$utils.formartNum(s.details.playCount))+"次",1)]),L("span",V,[W,I(" "+k(s.$utils.formartNum(s.details.subscribedCount)),1)]),L("span",X,[Z,I(" "+k(s.$utils.formartNum(s.details.commentCount)),1)])]),L("div",ss,[L("h5",null,[as,s.isShowDesc?(h(),b("em",{key:0,class:"desc-close",onClick:a[1]||(a[1]=a=>s.isShowDesc=!1)},[ls])):w("",!0)]),L("p",{innerHTML:s.details.description,onClick:a[2]||(a[2]=(...a)=>s.showAllDesc&&s.showAllDesc(...a))},null,8,["innerHTML"]),s.isShowDesc?(h(),b("pre",ts,"                                    "+k(s.details.description)+"\n                                ",1)):w("",!0)])])]),L("div",es,[L("div",is,[L("h4",null,[os,L("em",null,k(s.total+"首歌"),1)]),L("span",{class:"play-all",onClick:a[3]||(a[3]=(...s)=>t.playAllSongs&&t.playAllSongs(...s))},[cs,ns]),L("span",{class:["collect",s.details.subscribed?"active":""],onClick:a[4]||(a[4]=a=>t.subPlayList(s.details))},[L("i",{class:["iconfont","icon-collect"+(s.details.subscribed?"-active":"")]},null,2),I(" "+k(s.details.subscribed?"已收藏":"收藏"),1)],2)]),s.isLoading?(h(),b(n,{key:0})):(h(),b($,{key:1},[L(r,{songList:s.songList,stripe:!0},null,8,["songList"]),t.isLogin?w("",!0):(h(),b("div",rs,[L("span",{onClick:a[5]||(a[5]=(...s)=>t.loginDialog&&t.loginDialog(...s))},"登录后查看全部歌曲")]))],64))])]),L("div",ds,[L("div",ms,[us,L("div",ps,[(h(!0),b($,null,_(s.collects,(s=>(h(),b(c,{class:"collect-author",to:{path:"/singer",query:{id:s.userId}},key:s.userId},{default:q((()=>[L(o,{src:s.avatarUrl},{default:q((()=>[gs])),_:2},1032,["src"])])),_:2},1032,["to"])))),128))])]),L("div",vs,[ys,L("div",fs,[(h(!0),b($,null,_(s.playlists,(s=>(h(),b(c,{class:"recom-item",to:{path:"/playlist/detail",query:{id:s.id}},key:s.id},{default:q((()=>[L(o,{src:s.coverImgUrl},{default:q((()=>[hs])),_:2},1032,["src"]),L("div",bs,[L("div",Ls,k(s.name),1),L("div",ks,[ws,L(c,{to:{path:"/user",query:{id:s.creator.userId}}},{default:q((()=>[I(k(s.creator.nickname),1)])),_:2},1032,["to"])])])])),_:2},1032,["to"])))),128))])]),L("div",$s,[_s,L("div",Is,[(h(!0),b($,null,_(s.comments,(a=>(h(),b("div",{class:"comment-item",key:a.commentId},[L(c,{to:{path:"/user",query:{id:a.commentId}}},{default:q((()=>[L(o,{src:a.user.avatarUrl},{default:q((()=>[Ss])),_:2},1032,["src"])])),_:2},1032,["to"]),L("div",Ds,[L("div",js,[L(c,{to:{path:"/user",query:{id:a.commentId}},class:"comment-name"},{default:q((()=>[I(k(a.user.nickname),1)])),_:2},1032,["to"]),L("span",Cs,k(s.$utils.formatMsgTime(a.time)),1)]),L("div",Os,k(a.content),1)])])))),128))])])])])])])}));P.render=Ps,P.__scopeId="data-v-46060b16";export default P;
