var z=Object.defineProperty,N=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var U=(s,t,r)=>t in s?z(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,V=(s,t)=>{for(var r in t||(t={}))B.call(t,r)&&U(s,r,t[r]);if($)for(var r of $(t))F.call(t,r)&&U(s,r,t[r]);return s},I=(s,t)=>N(s,R(t));import{_ as O}from"./Loading.ed48931e.js";import{_ as j}from"./index.e9f38bbb.js";import{_ as E}from"./AlbumList.a7fbe126.js";import{_ as G}from"./MvList.a2d1f490.js";import{c as H,b as J,r as K,x as P,t as Q,p as W,a as X,e as d,a7 as Y,o as c,f as u,g as o,i as g,k as p,j as v,q as D,v as M,F as Z,h as x,m as ss,w as ts}from"./vendor.a7e3494f.js";const T={name:"Singer",components:{SongList:j,AlbumList:E,MvList:G,Loading:O},setup(s){const{proxy:t}=ss(),r=H(),n=J(),i=K({sUid:"",artist:null,hotSongs:[],hotAlbums:[],hotMvs:[],introduction:[],type:"hot",limit:12,offset:0,total:0,timer:null,dialogDescVisible:!1,isLoading:!0,isLoadMv:!0,album_loading:!0,album_count:12,mv_count:20,mv_loading:!0}),C=async()=>{const{data:e}=await t.$http.artistDesc({id:i.sUid,timestamp:new Date().valueOf()});if(e.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");i.introduction=e.introduction},m=async()=>{const{data:e}=await t.$http.artists({id:i.sUid,timestamp:new Date().valueOf()});if(e.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");i.artist=e.artist,i.hotSongs=e.hotSongs.map(l=>({id:String(l.id),name:l.name,mvId:l.mv,singer:l.ar,album:l.al,alia:l.alia,vip:l.fee===1,license:l.license,duration:t.$utils.formatSongTime(l.dt),url:`https://music.163.com/song/media/outer/url?id=${l.id}.mp3`,publishTime:t.$utils.formatMsgTime(l.publishTime)}))},b=async e=>{const{data:l}=await t.$http.artistSub({id:i.sUid,t:e});if(l.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");t.$msg.success("\u64CD\u4F5C\u6210\u529F"),m()},_=async()=>{i.album_loading=!0;const{data:e}=await t.$http.artistAlbum({id:i.sUid,limit:i.limit,offset:i.offset});if(e.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");i.total=e.artist.albumSize,i.hotAlbums=e.hotAlbums,i.album_loading=!1},h=async()=>{const{data:e}=await t.$http.artistMv({id:i.sUid,limit:20,offset:i.offset});if(e.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");i.hotMvs=[...i.hotMvs,...e.mvs],i.isLoading=e.hasMore,i.isLoadMv=!e.hasMore,i.offset+=20,i.mv_loading=!1},y=()=>{h()},k=()=>{i.dialogDescVisible=!0},A=e=>{const l={id:i.sUid};switch(i.type=e,i.offset=0,i.type){case"hot":m();break;case"album":_();break;case"mv":i.hotMvs=[],i.mv_loading=!0,h();break}e!=="hot"&&(l.type=i.type),r.push({path:"singer",query:l})},w=e=>{i.offset=(e-1)*i.limit,_()},L=()=>{switch(i.sUid=n.query.id,C(),i.type){case"hot":m();break;case"album":_();break;case"mv":h();break}},a=()=>{store.dispatch("playAll",{list:i.songList})},S=()=>{store.dispatch("addList",{list:i.hotSongs})},q=()=>{};return P(()=>{i.sUid=n.query.id,i.type=n.query.type||"hot",L(),n.query.type&&m()}),I(V({},Q(i)),{loadMv:y,currentChange:w,changeType:A,moreDesc:k,getArtistSub:b,playAllSongs:a,addAll:S,collectAll:q})},watch:{},beforeDestroy(){clearTimeout(this.timer)}},f=ts();W("data-v-64bc8e18");const os={key:0,class:"singer"},is={class:"w1200"},es={class:"singer-info"},ns={class:"singer-avatar"},as=o("div",{slot:"placeholder",class:"image-slot"},[o("i",{class:"iconfont icon-placeholder"})],-1),ls={class:"singer-desc"},rs={class:"singer-author"},ds={class:"singer-name"},cs=o("i",{class:"iconfont icon-home"},null,-1),us=v(" \u4E2A\u4EBA\u4E3B\u9875"),ms={class:"singer-brief"},gs={class:"singer-main"},ps={class:"w1200"},vs={class:"singer-hd"},_s=o("em",null,"\u4F5C\u54C1\u96C6",-1),hs={class:"singer-tab"},fs={key:0,class:"singer-oper"},bs=o("i",{class:"iconfont icon-audio-play"},null,-1),ys=v(" \u64AD\u653E\u5168\u90E8"),ks=o("i",{class:"iconfont icon-add"},null,-1),As=v(" \u6DFB\u52A0\u5230\u64AD\u653E\u5217\u8868"),ws=o("i",{class:"iconfont icon-collect"},null,-1),Ls=v(" \u6536\u85CF\u70ED\u95E8"),Ss={class:"singer-list"},Ds={class:"wrapper infinite-list","infinite-scroll-disabled":"isLoadMv","infinite-scroll-distance":"50"},Ms={key:0,class:"pagination"},Cs={class:"artist-desc-main"},$s={class:"introduction"},Us=o("dt",null,"\u827A\u4EBA\u4ECB\u7ECD",-1);X();const Vs=f((s,t,r,n,i,C)=>{const m=d("el-image"),b=d("router-link"),_=d("song-list"),h=d("album-list"),y=d("mv-list"),k=d("Loading"),A=d("el-pagination"),w=d("el-dialog"),L=Y("infinite-scroll");return s.artist?(c(),u("div",os,[o("div",is,[o("div",es,[o("div",ns,[o(m,{src:s.artist.img1v1Url},{default:f(()=>[as]),_:1},8,["src"])]),o("div",ls,[o("div",rs,[o("div",ds,g(s.artist.name),1),s.artist.accountId?(c(),u(b,{key:0,class:"singer-btn singer-home",to:{path:"/user",query:{id:s.artist.accountId}}},{default:f(()=>[cs,us]),_:1},8,["to"])):p("",!0),o("span",{class:["singer-btn","singer-collect",s.artist.followed?"active":""],onClick:t[1]||(t[1]=a=>n.getArtistSub(s.artist.followed?0:1))},[o("i",{class:["iconfont","icon-collect"+(s.artist.followed?"-active":"")]},null,2),v(" "+g(s.artist.followed?"\u5DF2\u6536\u85CF":"\u6536\u85CF"),1)],2)]),o("div",ms,[v(g(s.artist.briefDesc?s.artist.briefDesc:"\u6682\u65E0\u7B80\u4ECB")+" ",1),s.introduction.length?(c(),u("span",{key:0,onClick:t[2]||(t[2]=(...a)=>n.moreDesc&&n.moreDesc(...a))},"\u66F4\u591A>>")):p("",!0)])])])]),o("div",gs,[o("div",ps,[o("div",vs,[_s,o("div",hs,[o("span",{class:[s.type==="hot"?"active":""],onClick:t[3]||(t[3]=a=>n.changeType("hot"))},"\u70ED\u95E8\u4F5C\u54C1",2),o("span",{class:[s.type==="album"?"active":""],onClick:t[4]||(t[4]=a=>n.changeType("album"))},"\u6240\u6709\u4E13\u8F91",2),o("span",{class:[s.type==="mv"?"active":""],onClick:t[5]||(t[5]=a=>n.changeType("mv"))},"\u76F8\u5173MV",2)]),s.type==="hot"?(c(),u("div",fs,[o("span",{onClick:t[6]||(t[6]=(...a)=>n.playAllSongs&&n.playAllSongs(...a)),class:"singer-btn playAll"},[bs,ys]),o("span",{onClick:t[7]||(t[7]=(...a)=>n.addAll&&n.addAll(...a)),class:"singer-btn addAll"},[ks,As]),o("span",{onClick:t[8]||(t[8]=(...a)=>n.collectAll&&n.collectAll(...a)),class:"singer-btn collectAll"},[ws,Ls])])):p("",!0)]),o("div",Ss,[D(o(_,{songList:s.hotSongs,stripe:!0},null,8,["songList"]),[[M,s.type==="hot"]]),D(o("div",null,[o(h,{albumList:s.hotAlbums,loading:s.album_loading,num:s.album_count},null,8,["albumList","loading","num"])],512),[[M,s.type==="album"]]),D(o("div",Ds,[o(y,{mvList:s.hotMvs,loading:s.mv_loading,num:s.mv_count},null,8,["mvList","loading","num"]),s.isLoading?(c(),u(k,{key:0})):p("",!0)],512),[[M,s.type==="mv"],[L,n.loadMv]])]),s.type==="album"?(c(),u("div",Ms,[o(A,{onCurrentChange:n.currentChange,layout:"prev, pager, next","page-size":s.limit,total:s.total},null,8,["onCurrentChange","page-size","total"])])):p("",!0)])]),o(w,{title:s.artist.name,modelValue:s.dialogDescVisible,"onUpdate:modelValue":t[9]||(t[9]=a=>s.dialogDescVisible=a),"destroy-on-close":!0},{default:f(()=>[o("div",Cs,[o("dl",$s,[Us,o("dd",null,g(s.artist.briefDesc),1)]),(c(!0),u(Z,null,x(s.introduction,(a,S)=>(c(),u("dl",{key:S,class:"introduction"},[o("dt",null,g(a.ti),1),o("dd",null,g(a.txt),1)]))),128))])]),_:1},8,["title","modelValue"])])):p("",!0)});T.render=Vs;T.__scopeId="data-v-64bc8e18";export{T as default};
